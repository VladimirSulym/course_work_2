# Приложение для клиенто и в банка Т
### (Курсовая работа модуль 2)
## Описание:
Данное приложение для анализа транзакций, которые находятся в Excel-файле. 
Приложение умеет генерировать JSON-данные для веб-страниц приложения, 
формировать Excel-отчеты и предоставляет ряд других сервисов.
## Установка:
### 1. Клонируйте репозиторий:
```
git clone https://github.com/VladimirSulym/homework_module_2.git
```
### 2. Установите зависимости:
```
poetry install
```
### 3. Создайте файл .env из копии файла [.env.example](.env.example) и замените значения переменных реальными данными
### 4. Запуск тестирования:
```
pytest test/
```
## Использование и описание приложения:
1. Модул для запуска приложения - [main.py](main.py)
2. После запуска необходимо ввести дату в формате YYYY-MM-DD HH:MM:SS для Главной страницы. 
Эту операцию можно пропустить нажав Enter
3. Функция для страницы «Главная» расположена в модуле [views.py](src/views.py)
4. Функция сервиса «Выгодные категории повышенного кешбэка» расположена в модуле [services.py](src/services.py)
5. Функция сервиса «Траты по категории» расположена в модуле [reports.py](src/reports.py)
6. Все вспомогательные функции, для работы основных функций приложения, расположены в модуле 
[utils.py](src/utils.py), [dates.py](src/dates.py) и [api_requests.py](src/api_requests.py)
7. В программе реализовано тестирование. Все тесты лежат в папке [tests](tests)
8. Модуль [views.py](src/views.py) и [services.py](src/services.py) возвращает данные в формате JSON
9. Модуль [reports.py](src/reports.py) пишет отчеты в папку [data](data)
10. Для всех реализованных функций написаны docstring.
11. В программе реализовано тестирование. Все тесты лежат в папке [tests](tests)

## Описание модулей:
### [main.py](main.py)
Модуль, для получения результата всех реализованных в проекте функциональностей.

### [views.py](src/views.py)
Основные функции для генерации JSON-ответов реализованы в данном модуле.
Данные для анализа и вывода на веб-страницах — это данные с начала месяца,
на который выпадает входящая дата, по входящую дату.

Если дата — 20.05.2020, то данные для анализа будут в диапазоне 01.05.2020-20.05.2020.

Валюты и акции для отображения на веб-страницах задаются в отдельном файле 
пользовательских настроек [user_settings.json](data/user_settings.json)

Пример:
```
{
  "user_currencies": ["USD", "EUR"],
  "user_stocks": ["AAPL", "AMZN", "GOOGL", "MSFT", "TSLA"]
}
```
### [services.py](src/services.py)
В данном модуле реализованы сервисы приложения
При реализации сервисов используются элементы функционального программирования.

#### Выгодные категории повышенного кешбэка
Сервис позволяет проанализировать, какие категории были наиболее выгодными для выбора в качестве 
категорий повышенного кешбэка.
На вход функции поступают данные для анализа, год и месяц.

Входные параметры:

* data — данные с транзакциями;
* year — год, за который проводится анализ;
* month — месяц, за который проводится анализ.

На выходе — JSON с анализом, сколько на каждой категории можно заработать кешбэка в указанном месяце года.

Выходные параметры:

JSON с анализом, сколько на каждой категории можно заработать кешбэка.

Формат выходных данных:
```
{
    "Категория 1": 1000,
    "Категория 2": 2000,
    "Категория 3": 500
}
```

### [reports.py](src/reports.py)

В данном модули реализованы отчеты.

Создан декоратор для функций-отчетов, который записывает в файл результат, 
который возвращает функция, формирующая отчет.

Декоратор без параметра — записывает данные отчета в файл с названием по умолчанию 
(формат имени файла придумайте самостоятельно).
Декоратор с параметром — принимает имя файла в качестве параметра.

#### Траты по категории

Функция принимает на вход:
* датафрейм с транзакциями,
* название категории,
* опциональную дату. 
 
Если дата не передана, то берется текущая дата.
Функция возвращает траты по заданной категории за последние три месяца (от переданной даты).

Интерфейс трат по категории
```
def spending_by_category(transactions: pd.DataFrame,
                         category: str,
                         date: Optional[str] = None) -> pd.DataFrame:
    pass
```
## Документация:
Для получения дополнительной информации обратитесь к [документации](README.md).
## Лицензия:
Этот проект лицензирован по [лицензии MIT](LICENSE).